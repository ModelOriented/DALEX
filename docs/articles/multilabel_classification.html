<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use multilabel classification and DALEX? • DALEX</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- dalexverse --><link href="../dalexverse.css" rel="stylesheet">
<link href="../dalexverse-2.css" rel="stylesheet">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to use multilabel classification and DALEX?">
<meta property="og:description" content="">
<meta property="og:image" content="">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">DALEX</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">1.2.0</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/multilabel_classification.html">How to use multilabel classification and DALEX?</a>
    </li>
    <li>
      <a href="../articles/vignette_titanic.html">Survival on the RMS Titanic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ModelOriented/DALEX">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="multilabel_classification_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>How to use multilabel classification and DALEX?</h1>
                        <h4 class="author">Szymon Maksymiuk</h4>
            
            <h4 class="date">2020-04-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ModelOriented/DALEX/blob/master/vignettes/multilabel_classification.Rmd"><code>vignettes/multilabel_classification.Rmd</code></a></small>
      <div class="hidden name"><code>multilabel_classification.Rmd</code></div>

    </div>

    
    
<div id="data-for-titanic-survival" class="section level1">
<h1 class="hasAnchor">
<a href="#data-for-titanic-survival" class="anchor"></a>Data for Titanic survival</h1>
<p>In the following vignette we will march through multilabel classification with <code>DALEX</code>. Purpose of of this examples is that for some of <code>DALEX</code> functionalities binary cliassification is default one, and therefore we need to put some self-made code to work here. All of examples will be performed with <code>HR</code> dataset that is available with <code>DALEX</code>, it’s target column is <code>status</code> with three level factor. For all cases our model will be <code>ranger</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"DALEX"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(HR)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(HR)</span></code></pre></div>
<pre><code>#&gt;   gender      age    hours evaluation salary   status
#&gt; 1   male 32.58267 41.88626          3      1    fired
#&gt; 2 female 41.21104 36.34339          2      5    fired
#&gt; 3   male 37.70516 36.81718          3      0    fired
#&gt; 4 female 30.06051 38.96032          3      2    fired
#&gt; 5   male 21.10283 62.15464          5      3 promoted
#&gt; 6   male 40.11812 69.53973          2      0    fired</code></pre>
</div>
<div id="creation-of-model-and-explainer" class="section level1">
<h1 class="hasAnchor">
<a href="#creation-of-model-and-explainer" class="anchor"></a>Creation of model and explainer</h1>
<p>Ok, now it is time to create a model.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ranger"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>model_HR_ranger &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/ranger/man/ranger.html">ranger</a></span>(status<span class="op">~</span>.,  <span class="dt">data =</span> HR, <span class="dt">probability =</span> <span class="ot">TRUE</span>, <span class="dt">num.trees =</span> <span class="dv">50</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>model_HR_ranger</span></code></pre></div>
<pre><code>#&gt; Ranger result
#&gt; 
#&gt; Call:
#&gt;  ranger(status ~ ., data = HR, probability = TRUE, num.trees = 50) 
#&gt; 
#&gt; Type:                             Probability estimation 
#&gt; Number of trees:                  50 
#&gt; Sample size:                      7847 
#&gt; Number of independent variables:  5 
#&gt; Mtry:                             2 
#&gt; Target node size:                 10 
#&gt; Variable importance mode:         none 
#&gt; Splitrule:                        gini 
#&gt; OOB prediction error (Brier s.):  0.2173953</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"DALEX"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>explain_HR_ranger &lt;-<span class="st"> </span><span class="kw"><a href="../reference/explain.html">explain</a></span>(model_HR_ranger,</span>
<span id="cb5-3"><a href="#cb5-3"></a>                              <span class="dt">data =</span> HR[,<span class="op">-</span><span class="dv">6</span>],</span>
<span id="cb5-4"><a href="#cb5-4"></a>                              <span class="dt">y =</span> HR<span class="op">$</span>status,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                              <span class="dt">label =</span> <span class="st">"Ranger Multilabel Classification"</span>,</span>
<span id="cb5-6"><a href="#cb5-6"></a>                              <span class="dt">colorize =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>#&gt; Preparation of a new explainer is initiated
#&gt;   -&gt; model label       :  Ranger Multilabel Classification 
#&gt;   -&gt; data              :  7847  rows  5  cols 
#&gt;   -&gt; target variable   :  7847  values 
#&gt;   -&gt; target variable   :  Please note that 'y' is a factor.  (  WARNING  )
#&gt;   -&gt; target variable   :  Consider changing the 'y' to a logical or numerical vector.
#&gt;   -&gt; target variable   :  Otherwise I will not be able to calculate residuals or loss function.
#&gt;   -&gt; model_info        :  package ranger , ver. 0.12.1 , task classification (  default  ) 
#&gt;   -&gt; predict function  :  yhat.ranger  will be used (  default  )
#&gt;   -&gt; predicted values  :  predict function returns multiple columns:  3  (  WARNING  ) some of functionalities may not work 
#&gt;   -&gt; residual function :  difference between y and yhat (  default  )
#&gt;   -&gt; residuals         :  numerical, min =  NA , mean =  NA , max =  NA  
#&gt;   A new explainer has been created!</code></pre>
<p>Ofcourse sixth column, that we have omitted during creation of explainer, stands for target column (<code>status</code>) and it is good practice not to put it in <code>data</code>. Keep in mind that default <code>yhat</code> function for <code>ranger</code> and for any other package that is supported by <code>DALEX</code>, enforces probability output. Therfore residuals are NA since we didn’t provide residual function meaningful for factors and probability matrix.</p>
</div>
<div id="variable-importance" class="section level1">
<h1 class="hasAnchor">
<a href="#variable-importance" class="anchor"></a>Variable Importance</h1>
<p>In order to use <code><a href="../reference/model_parts.html">variable_importance()</a></code> function it is necessary to switch default <code>loss_function</code> argument to one that handle multiple classes. <code>DALEX</code> has one function like that implemented and it is called <code><a href="../reference/loss_functions.html">loss_cross_entropy()</a></code>. To use this, <code>y</code> parameter passed to <code>explain</code> function should be numeric vector that encodes classes to <em>positive</em> integers. See example below.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>y_HR &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(HR<span class="op">$</span>status)</span>
<span id="cb7-2"><a href="#cb7-2"></a>y_HR[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>#&gt;  [1] 1 1 1 1 3 1 3 2 1 3</code></pre>
<p>Also we need probability outputs so there is no need to change deafult <code>predict_function</code> parameter.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"DALEX"</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>explain_HR_ranger_new_y &lt;-<span class="st"> </span><span class="kw"><a href="../reference/explain.html">explain</a></span>(model_HR_ranger,</span>
<span id="cb9-3"><a href="#cb9-3"></a>                              <span class="dt">data =</span> HR[,<span class="op">-</span><span class="dv">6</span>],</span>
<span id="cb9-4"><a href="#cb9-4"></a>                              <span class="dt">y =</span> y_HR,</span>
<span id="cb9-5"><a href="#cb9-5"></a>                              <span class="dt">label =</span> <span class="st">"Ranger Multilabel Classification"</span>,</span>
<span id="cb9-6"><a href="#cb9-6"></a>                              <span class="dt">colorize =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>#&gt; Preparation of a new explainer is initiated
#&gt;   -&gt; model label       :  Ranger Multilabel Classification 
#&gt;   -&gt; data              :  7847  rows  5  cols 
#&gt;   -&gt; target variable   :  7847  values 
#&gt;   -&gt; model_info        :  package ranger , ver. 0.12.1 , task classification (  default  ) 
#&gt;   -&gt; predict function  :  yhat.ranger  will be used (  default  )
#&gt;   -&gt; predicted values  :  predict function returns multiple columns:  3  (  WARNING  ) some of functionalities may not work 
#&gt;   -&gt; residual function :  difference between y and yhat (  default  )
#&gt;   -&gt; residuals         :  numerical, min =  0.005066491 , mean =  1.655962 , max =  3  
#&gt;   A new explainer has been created!</code></pre>
<p>And now we can use <code><a href="../reference/model_parts.html">variable_importance()</a></code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>vi &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_parts.html">variable_importance</a></span>(explain_HR_ranger_new_y, <span class="dt">loss_function =</span> loss_cross_entropy)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(vi)</span></code></pre></div>
<p><img src="multilabel_classification_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>As we see above, we can enjoy perfectly fine variable importance plot.</p>
</div>
<div id="variable-effects" class="section level1">
<h1 class="hasAnchor">
<a href="#variable-effects" class="anchor"></a>Variable effects</h1>
<p>There is no need for tricks in order to use <code><a href="../reference/variable_effect.html">variable_effect()</a></code>. Our target will be one-hot-encoded, and all of explantions will be performed for each of class separately.</p>
<div id="partial_dependency" class="section level2">
<h2 class="hasAnchor">
<a href="#partial_dependency" class="anchor"></a>partial_dependency</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>ve_p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_profile.html">variable_profile</a></span>(explain_HR_ranger, <span class="dt">variables =</span> <span class="st">"salary"</span>, <span class="dt">type =</span> <span class="st">"partial"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>ve_p<span class="op">$</span>color =<span class="st"> "_label_"</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ve_p)</span></code></pre></div>
<p><img src="multilabel_classification_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="accumulated_dependency" class="section level2">
<h2 class="hasAnchor">
<a href="#accumulated_dependency" class="anchor"></a>accumulated_dependency</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>ve_a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_profile.html">variable_profile</a></span>(explain_HR_ranger, <span class="dt">variables =</span> <span class="st">"salary"</span>, <span class="dt">type =</span> <span class="st">"accumulated"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>ve_a<span class="op">$</span>color =<span class="st"> "_label_"</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(ve_a)</span></code></pre></div>
<p><img src="multilabel_classification_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
<div id="instance-level-explanations" class="section level1">
<h1 class="hasAnchor">
<a href="#instance-level-explanations" class="anchor"></a>Instance level explanations</h1>
<p>As above, <code><a href="../reference/predict_parts.html">variable_attribution()</a></code> works perfectly fine with multilabel classification and default explainer. Just like before, our target will be splitted into variables standing for each factor level and computations will be performed then.</p>
<div id="break_down" class="section level2">
<h2 class="hasAnchor">
<a href="#break_down" class="anchor"></a>break_down</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>bd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict_parts.html">variable_attribution</a></span>(explain_HR_ranger, HR[<span class="dv">1</span>,], <span class="dt">type =</span> <span class="st">"break_down"</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(bd)</span></code></pre></div>
<p><img src="multilabel_classification_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="shap" class="section level2">
<h2 class="hasAnchor">
<a href="#shap" class="anchor"></a>shap</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>shap &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict_parts.html">variable_attribution</a></span>(explain_HR_ranger, HR[<span class="dv">1</span>,], <span class="dt">type =</span> <span class="st">"shap"</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(shap)</span></code></pre></div>
<p><img src="multilabel_classification_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
<div id="model_performance-and-individual_diagnostics" class="section level1">
<h1 class="hasAnchor">
<a href="#model_performance-and-individual_diagnostics" class="anchor"></a>model_performance and individual_diagnostics</h1>
<p>Those two function are merged into one paragraph becasue they require same action in order to get them work with multilabel classification. The most important thing here is to realise that both function are based on residuals. Therfore we need proper residual_function. Let’s assume for purpose of that vignette that residual is one minus probability that true class has.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>residual_function &lt;-<span class="st"> </span><span class="cf">function</span>(model, data, y) {</span>
<span id="cb16-2"><a href="#cb16-2"></a>  y_char &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(y)</span>
<span id="cb16-3"><a href="#cb16-3"></a>  pred &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(model, data, <span class="dt">probability =</span> <span class="ot">TRUE</span>)<span class="op">$</span>predictions </span>
<span id="cb16-4"><a href="#cb16-4"></a>  res &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>()</span>
<span id="cb16-5"><a href="#cb16-5"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(pred)) {</span>
<span id="cb16-6"><a href="#cb16-6"></a>    res[i] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>pred[i, y_char[i]]</span>
<span id="cb16-7"><a href="#cb16-7"></a>  }</span>
<span id="cb16-8"><a href="#cb16-8"></a>  res</span>
<span id="cb16-9"><a href="#cb16-9"></a>}</span></code></pre></div>
<p>Now we can create and explainer and pass our brand new residual_function to it.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>explain_HR_ranger_residual &lt;-<span class="st"> </span><span class="kw"><a href="../reference/explain.html">explain</a></span>(model_HR_ranger,</span>
<span id="cb17-2"><a href="#cb17-2"></a>                              <span class="dt">data =</span> HR[,<span class="op">-</span><span class="dv">6</span>],</span>
<span id="cb17-3"><a href="#cb17-3"></a>                              <span class="dt">y =</span> HR<span class="op">$</span>status,</span>
<span id="cb17-4"><a href="#cb17-4"></a>                              <span class="dt">label =</span> <span class="st">"Ranger Multilabel Classification"</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>                              <span class="dt">residual_function =</span> residual_function,</span>
<span id="cb17-6"><a href="#cb17-6"></a>                              <span class="dt">colorize =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>#&gt; Preparation of a new explainer is initiated
#&gt;   -&gt; model label       :  Ranger Multilabel Classification 
#&gt;   -&gt; data              :  7847  rows  5  cols 
#&gt;   -&gt; target variable   :  7847  values 
#&gt;   -&gt; target variable   :  Please note that 'y' is a factor.  (  WARNING  )
#&gt;   -&gt; target variable   :  Consider changing the 'y' to a logical or numerical vector.
#&gt;   -&gt; target variable   :  Otherwise I will not be able to calculate residuals or loss function.
#&gt;   -&gt; model_info        :  package ranger , ver. 0.12.1 , task classification (  default  ) 
#&gt;   -&gt; predict function  :  yhat.ranger  will be used (  default  )
#&gt;   -&gt; predicted values  :  predict function returns multiple columns:  3  (  WARNING  ) some of functionalities may not work 
#&gt;   -&gt; residual function :  residual_function 
#&gt;   -&gt; residuals         :  numerical, min =  0 , mean =  0.2765554 , max =  0.8904417  
#&gt;   A new explainer has been created!</code></pre>
<div id="model_performance" class="section level2">
<h2 class="hasAnchor">
<a href="#model_performance" class="anchor"></a>model_performance</h2>
<p>TODO: this is not implmented for multiclass models</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>mp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_performance.html">model_performance</a></span>(explain_HR_ranger_residual)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(mp)</span></code></pre></div>
</div>
<div id="residuals_distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#residuals_distribution" class="anchor"></a>residuals_distribution</h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>rd_all &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict_diagnostics.html">individual_diagnostics</a></span>(explain_HR_ranger_residual, HR[<span class="dv">1</span>,])</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(rd_all)</span></code></pre></div>
<p><img src="multilabel_classification_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>rd_salary &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict_diagnostics.html">individual_diagnostics</a></span>(explain_HR_ranger_residual, HR[<span class="dv">1</span>,], <span class="dt">variables =</span> <span class="st">"salary"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(rd_salary)</span></code></pre></div>
<p><img src="multilabel_classification_files/figure-html/unnamed-chunk-14-2.png" width="700"> # Session info</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</span></code></pre></div>
<pre><code>#&gt; R version 3.6.3 (2020-02-29)
#&gt; Platform: x86_64-apple-darwin15.6.0 (64-bit)
#&gt; Running under: macOS Catalina 10.15.3
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
#&gt; 
#&gt; locale:
#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     
#&gt; 
#&gt; other attached packages:
#&gt; [1] ranger_0.12.1 DALEX_1.2.0  
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] Rcpp_1.0.4        gower_0.2.1       compiler_3.6.3    pillar_1.4.3     
#&gt;  [5] ingredients_1.2.0 tools_3.6.3       digest_0.6.25     lattice_0.20-38  
#&gt;  [9] evaluate_0.14     memoise_1.1.0     lifecycle_0.2.0   tibble_3.0.0     
#&gt; [13] gtable_0.3.0      pkgconfig_2.0.3   rlang_0.4.5       Matrix_1.2-18    
#&gt; [17] cli_2.0.2         rstudioapi_0.11   yaml_2.2.1        pkgdown_1.4.1    
#&gt; [21] xfun_0.13         dplyr_0.8.5       stringr_1.4.0     knitr_1.28       
#&gt; [25] desc_1.2.0        fs_1.3.1          vctrs_0.2.4       tidyselect_1.0.0 
#&gt; [29] rprojroot_1.3-2   grid_3.6.3        glue_1.4.0        R6_2.4.1         
#&gt; [33] fansi_0.4.1       iBreakDown_1.2.0  rmarkdown_2.1     farver_2.0.3     
#&gt; [37] purrr_0.3.3       ggplot2_3.3.0     magrittr_1.5      backports_1.1.6  
#&gt; [41] scales_1.1.0      htmltools_0.4.0   ellipsis_0.3.0    MASS_7.3-51.5    
#&gt; [45] assertthat_0.2.1  colorspace_1.4-1  labeling_0.3      stringi_1.4.6    
#&gt; [49] munsell_0.5.0     crayon_1.3.4</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data-for-titanic-survival">Data for Titanic survival</a></li>
      <li><a href="#creation-of-model-and-explainer">Creation of model and explainer</a></li>
      <li><a href="#variable-importance">Variable Importance</a></li>
      <li>
<a href="#variable-effects">Variable effects</a>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#partial_dependency">partial_dependency</a></li>
      <li><a href="#accumulated_dependency">accumulated_dependency</a></li>
      </ul>
</li>
      <li>
<a href="#instance-level-explanations">Instance level explanations</a>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#break_down">break_down</a></li>
      <li><a href="#shap">shap</a></li>
      </ul>
</li>
      <li>
<a href="#model_performance-and-individual_diagnostics">model_performance and individual_diagnostics</a>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#model_performance">model_performance</a></li>
      <li><a href="#residuals_distribution">residuals_distribution</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
